<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø£Ù…Ù†ÙŠ - Ø´Ù…Ø§Ù„ Ø³ÙŠÙ†Ø§Ø¡</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <style>
    body { margin: 0; font-family: 'Arial'; background: #f9f9f9; }
    #map { height: 90vh; width: 100%; }
    .controls {
      padding: 10px;
      background: #fff;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      display: flex;
      justify-content: center;
      gap: 10px;
    }
    button {
      padding: 10px 15px;
      border: none;
      border-radius: 6px;
      background: #2a5d9f;
      color: white;
      cursor: pointer;
    }
    button:hover {
      background: #1d467b;
    }
    #info {
      text-align: center;
      padding: 10px;
      color: #333;
    }
  </style>
</head>
<body>

<div class="controls">
  <button onclick="toggleLayer('watch')">Ø¹Ø±Ø¶ Ø£Ø¨Ø±Ø§Ø¬ Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø©</button>
  <button onclick="toggleLayer('supply')">Ø¹Ø±Ø¶ Ù…Ø³Ø§Ø±Ø§Øª Ø§Ù„Ø¥Ù…Ø¯Ø§Ø¯</button>
  <button onclick="toggleLayer('patrol')">Ø¹Ø±Ø¶ Ù…Ø³Ø§Ø±Ø§Øª Ø§Ù„Ø¯ÙˆØ±ÙŠØ§Øª</button>
  <button onclick="toggleLayer('displacement')">Ø¹Ø±Ø¶ Ù…Ø³Ø§Ø±Ø§Øª Ø§Ù„Ù†Ø²ÙˆØ­</button>
  <button onclick="window.location.href='index.html'">Ø§Ù„Ø±Ø¬ÙˆØ¹ Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
</div>

<div id="info">Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø²Ø± Ù„Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª.</div>
<div id="map"></div>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script>
  const map = L.map('map').setView([31.25, 33.8], 9);

  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: '&copy; OpenStreetMap contributors'
  }).addTo(map);

  const layers = {
    watch: null,
    supply: null,
    patrol: null,
    displacement: null
  };

  const infoTexts = {
    watch: `ğŸŸ¥ <strong>Ø£Ø¨Ø±Ø§Ø¬ Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø©:</strong> Ù†Ù‚Ø§Ø· ØªÙ…Ø±ÙƒØ² Ù„Ø±ØµØ¯ Ø§Ù„Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø­Ø¯ÙˆØ¯ÙŠØ© ÙˆØ­Ù…Ø§ÙŠØ© Ø§Ù„Ø£Ù…Ù†.<br>ğŸŸ¦ <strong>Ø§Ù„Ø·Ø±Ù‚ Ø§Ù„Ø¸Ø§Ù‡Ø±Ø© Ø¨Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ø£Ø²Ø±Ù‚:</strong> (Ù…Ø³Ø§Ø±Ø§Øª Ø§Ù„Ø¯ÙˆØ±ÙŠØ§Øª) ØªÙ‚Ø¹ ÙÙŠ Ù…Ø¬Ø§Ù„ Ø±Ø¤ÙŠØ© Ø§Ù„Ø£Ø¨Ø±Ø§Ø¬ ÙˆØªØ´ÙƒÙ„ Ù…Ø­Ø§ÙˆØ± ØªØ£Ù…ÙŠÙ† Ø­ÙŠÙˆÙŠØ©.`,
    supply: 'ğŸŸ© <strong>Ù…Ø³Ø§Ø±Ø§Øª Ø§Ù„Ø¥Ù…Ø¯Ø§Ø¯:</strong> Ø·Ø±Ù‚ ØªÙØ³ØªØ®Ø¯Ù… Ù„ØªÙˆØµÙŠÙ„ Ø§Ù„Ø¯Ø¹Ù… ÙˆØ§Ù„ØªÙ…ÙˆÙŠÙ† Ù„Ù„Ù…Ù†Ø§Ø·Ù‚.',
    patrol: 'ğŸŸ¦ <strong>Ù…Ø³Ø§Ø±Ø§Øª Ø§Ù„Ø¯ÙˆØ±ÙŠØ§Øª:</strong> Ø§Ù„Ø·Ø±Ù‚ Ø§Ù„ØªÙŠ ØªØ³Ù„ÙƒÙ‡Ø§ Ù‚ÙˆØ§Øª Ø§Ù„Ø£Ù…Ù† Ù„ØªØ£Ù…ÙŠÙ† Ø§Ù„Ù…Ù†Ø§Ø·Ù‚.',
    displacement: 'ğŸŸ§ <strong>Ù…Ø³Ø§Ø±Ø§Øª Ø§Ù„Ù†Ø²ÙˆØ­:</strong> Ø§Ù„Ø·Ø±Ù‚ Ø§Ù„ØªÙŠ Ø³Ù„ÙƒÙ‡Ø§ Ø§Ù„Ø³ÙƒØ§Ù† Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø¥Ø®Ù„Ø§Ø¡ Ø£Ùˆ Ø§Ù„Ù‡Ø¬Ø±Ø©.'
  };

  function loadLayer(name, file, color, isPoint = false) {
    fetch(file)
      .then(res => res.json())
      .then(data => {
        layers[name] = L.geoJSON(data, {
          style: isPoint ? null : {
            color: color,
            weight: 3
          },
          pointToLayer: function (feature, latlng) {
            return L.circleMarker(latlng, {
              radius: 6,
              fillColor: color,
              color: "#000",
              weight: 1,
              opacity: 1,
              fillOpacity: 0.8
            });
          },
          onEachFeature: function (feature, layer) {
            let popup = "";
            if (feature.properties) {
              for (let key in feature.properties) {
                popup += `<strong>${key}</strong>: ${feature.properties[key]}<br>`;
              }
            }
            layer.bindPopup(popup);
          }
        });
      });
  }

  // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø·Ø¨Ù‚Ø§Øª (ØªØ£ÙƒØ¯ÙŠ Ø¥Ù† Ø§Ù„Ù…Ù„ÙØ§Øª Ø¯Ø§Ø®Ù„ Ù…Ø¬Ù„Ø¯ data/)
  loadLayer('watch', 'data/watch_towers.geojson', 'red', true);
  loadLayer('supply', 'data/supply_routes.geojson', 'green');
  loadLayer('patrol', 'data/patrol_routes.geojson', 'blue');
  loadLayer('displacement', 'data/displacement_routes.geojson', 'orange');

  function toggleLayer(name) {
    for (let key in layers) {
      if (layers[key] && map.hasLayer(layers[key])) {
        map.removeLayer(layers[key]);
      }
    }

    if (layers[name]) {
      layers[name].addTo(map);
      document.getElementById('info').innerHTML = infoTexts[name];
    } else {
      document.getElementById('info').innerText = 'Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„... Ø£Ø¹Ø¯ Ø§Ù„Ø¶ØºØ· Ø¨Ø¹Ø¯ Ø«Ø§Ù†ÙŠØ©.';
    }
  }
</script>

</body>
</html>
